!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(3),e.exports=n(2)},function(e,t,n){!function(){"use strict";"undefined"!=typeof document&&function(e){var t;function n(){t||(t=!0,e())}["interactive","complete"].indexOf(document.readyState)>=0?e():(t=!1,document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1))}(function(){var e=!0,t=!1,n=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function i(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function s(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function r(t){e=!1}function a(){document.addEventListener("mousemove",c),document.addEventListener("mousedown",c),document.addEventListener("mouseup",c),document.addEventListener("pointermove",c),document.addEventListener("pointerdown",c),document.addEventListener("pointerup",c),document.addEventListener("touchmove",c),document.addEventListener("touchstart",c),document.addEventListener("touchend",c)}function c(t){"html"!==t.target.nodeName.toLowerCase()&&(e=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mousedown",c),document.removeEventListener("mouseup",c),document.removeEventListener("pointermove",c),document.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchstart",c),document.removeEventListener("touchend",c))}document.addEventListener("keydown",function(t){i(document.activeElement)&&s(document.activeElement),e=!0},!0),document.addEventListener("mousedown",r,!0),document.addEventListener("pointerdown",r,!0),document.addEventListener("touchstart",r,!0),document.addEventListener("focus",function(t){var n,r,a;i(t.target)&&((e||(n=t.target,r=n.type,"INPUT"==(a=n.tagName)&&o[r]&&!n.readOnly||"TEXTAREA"==a&&!n.readOnly||n.isContentEditable))&&s(t.target))},!0),document.addEventListener("blur",function(e){var o;i(e.target)&&((e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(t=!0,window.clearTimeout(n),n=window.setTimeout(function(){t=!1,window.clearTimeout(n)},100),(o=e.target).hasAttribute("data-focus-visible-added")&&(o.classList.remove("focus-visible"),o.removeAttribute("data-focus-visible-added"))))},!0),document.addEventListener("visibilitychange",function(n){"hidden"==document.visibilityState&&(t&&(e=!0),a())},!0),a(),document.body.classList.add("js-focus-visible")})}()},function(e,t,n){},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t);var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.canvas=document.querySelector(t.canvas),this.canvas&&(this.context=this.canvas.getContext("2d"),this.color="red",this.size=this.prop_set(t.size,20),this.num_x=t.num_x,this.num_y=t.num_y,this.init_canvas())}var t,n,i;return t=e,(n=[{key:"init_canvas",value:function(){if(this.prepare_canvas(),this.attach_events(),this.options.pattern&&this.parse_pattern(),this.options.fill){for(var e=Math.round(this.get_parent_width()/this.size/2),t=0;t<e;t++)this.squares.push({x:this.size*(2*t),y:0});this.draw_squares()}}},{key:"attach_events",value:function(){this.place_square=this.place_square.bind(this),this.canvas.addEventListener("click",this.place_square)}},{key:"place_square",value:function(e){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var t=e.pageX-e.target.offsetLeft,n=e.pageY-e.target.offsetTop,o=t-t%this.size,i=n-n%this.size;i===this.canvas.height&&(i-=this.size),o===this.canvas.width&&(o-=this.size);var s=this.squares.findIndex(function(e){return e.x===o&e.y===i});s>-1?this.squares.splice(s,1):this.squares.push({x:o,y:i}),this.draw_squares(this.context,this.squares)}},{key:"prop_set",value:function(e,t){return e||t}},{key:"prepare_canvas",value:function(){this.canvas.classList.add("square-canvas--visible"),this.canvas.width=this.num_x*this.size,this.canvas.height=this.num_y*this.size,"infinite"===this.num_x&&(this.canvas.width=this.get_parent_width()),this.squares=[]}},{key:"get_parent_width",value:function(){var e=getComputedStyle(this.canvas.parentNode),t=this.canvas.parentNode.clientWidth;return t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)}},{key:"parse_pattern",value:function(){for(var e=this.options.pattern.split(","),t=0;t<e.length;t++){var n=parseInt(e[t].trim()),o=Math.floor(t/this.num_x),i=(t+this.num_x)%this.num_x;"infinite"===this.num_x&&(o=0,i=t),n&&this.squares.push({x:this.size*i,y:this.size*o})}this.draw_squares()}},{key:"draw_squares",value:function(){this.context.fillStyle=this.prop_set(this.options.color,"rgba(51, 51, 51, 0.9)");for(var e=0;e<this.squares.length;e++){var t=this.squares[e];this.context.fillRect(t.x,t.y,this.size,this.size)}}}])&&o(t.prototype,n),i&&o(t,i),e}(),s=s||function(e){var t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},r=s;var a,c=function(){navigator.connection&&(navigator.connection.effectiveType.includes("2g")||navigator.connection.saveData)||r(function(){!function(){for(var e,t,n=document.querySelectorAll(".js-nav-main a"),o=0;o<n.length;o++)e=n[o].href,t=void 0,((t=document.createElement("link")).relList||{}).supports&&!t.relList.supports("prefetch")||(t.rel="prefetch",t.href=e,document.head.appendChild(t))}()})};function u(e){var t,n=e.dataset.src;return(t=n,new Promise(function(e,n){var o=new Image;o.src=t,o.onload=e,o.onerror=n})).then(function(){e.classList.add("lazyloaded"),e.src=n,e.removeAttribute("data-src")})}function d(e){for(var t=0;t<e.length;t++){var n=e[t];n.intersectionRatio>0&&(a.unobserve(n.target),u(n.target))}}var l=function(e){if(e.length){a=new IntersectionObserver(d,{rootMargin:"100px 0px"});for(var t=0;t<e.length;t++){var n=e[t];n.classList.contains("lazyloaded")||a.observe(n)}}};n(1),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var m;new i({canvas:".js-sq-tl",num_x:1,num_y:1,pattern:"1",color:"#36B1BF"}),new i({canvas:".js-sq-tr",num_x:2,num_y:1,pattern:"1,1",color:"#36B1BF"}),new i({canvas:".js-sq-br",num_x:1,num_y:2,pattern:"1,1",color:"#F23C50"}),new i({canvas:".js-sq-bl",num_x:2,num_y:2,pattern:"1,0,1,1",color:"#F23C50"}),new i({canvas:".js-sq-home-intro",num_x:6,num_y:5,color:"#568b8e",size:10,pattern:"0,0,1,1,0,1,\n    0,1,1,0,0,1,\n    1,1,0,0,0,1,\n    0,1,1,0,0,0,\n    0,0,1,1,0,1"}),new i({canvas:".js-sq-site-header",num_x:"infinite",num_y:1,size:5,color:"#1d4e6d",fill:"even"});function v(){event.preventDefault();var e=event.target.closest("a"),t="".concat(e.dataset.publication,"-").concat(e.dataset.post);document.documentElement.setAttribute("data-theme",t),history.pushState({theme:t},e.href,e.href),h(e.href)}function h(e){var t=document.querySelector(".js-site-content");t.innerHTML="",t.classList.add("site__content--hidden");var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){var e=document.createElement("div");200===this.status&&(e.innerHTML=this.response,t.innerHTML=e.querySelector(".js-site-content").innerHTML,t.classList.remove("site__content--hidden"),t.querySelector(".js-post-list")&&t.querySelector(".js-post-list").addEventListener("click",v),l(t.querySelectorAll("img[data-src]")))},n.onerror=function(){page_content.innerHTML="For some reason I couldn't connect to the server, please try later again."},n.send()}document.querySelector(".js-random-emoji")&&(document.querySelector(".js-random-emoji").textContent=(m=["ðŸ¤¤","ðŸ³","ðŸ»","ðŸ‘ŠðŸ»","ðŸ³"])[Math.round(Math.random()*(m.length-1))]),document.querySelector(".js-scroll-top")&&document.querySelector(".js-scroll-top").addEventListener("click",function(e){e.preventDefault(),document.querySelector(".js-logo").focus()}),c(),history.pushState({theme:location.pathname.replace(/\//g,"")},location.pathname,location.pathname),document.querySelector(".js-post-list")&&document.querySelector(".js-post-list").addEventListener("click",v),window.onpopstate=function(e){e.state&&(document.documentElement.setAttribute("data-theme",e.state.theme),h(location.pathname))},l(document.querySelectorAll("img[data-src]"))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2ZvY3VzLXZpc2libGUvZGlzdC9mb2N1cy12aXNpYmxlLmpzIiwid2VicGFjazovLy8uL3N0YXRpYy9zY3JpcHRzL3NxdWFyZXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljL3NjcmlwdHMvcmVxdWVzdC1pZGxlLWNhbGxiYWNrLmpzIiwid2VicGFjazovLy8uL3N0YXRpYy9zY3JpcHRzL3ByZWZldGNoLW5hdi5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWMvc2NyaXB0cy9sYXp5bG9hZC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWMvc2NyaXB0cy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImRvY3VtZW50IiwiY2FsbGJhY2siLCJsb2FkZWQiLCJsb2FkIiwiaW5kZXhPZiIsInJlYWR5U3RhdGUiLCJhZGRFdmVudExpc3RlbmVyIiwid2luZG93Iiwib25ET01SZWFkeSIsImhhZEtleWJvYXJkRXZlbnQiLCJoYWRGb2N1c1Zpc2libGVSZWNlbnRseSIsImhhZEZvY3VzVmlzaWJsZVJlY2VudGx5VGltZW91dCIsImlucHV0VHlwZXNXaGl0ZWxpc3QiLCJ0ZXh0Iiwic2VhcmNoIiwidXJsIiwidGVsIiwiZW1haWwiLCJwYXNzd29yZCIsIm51bWJlciIsImRhdGUiLCJtb250aCIsIndlZWsiLCJ0aW1lIiwiZGF0ZXRpbWUiLCJkYXRldGltZS1sb2NhbCIsImlzVmFsaWRGb2N1c1RhcmdldCIsImVsIiwibm9kZU5hbWUiLCJjbGFzc0xpc3QiLCJhZGRGb2N1c1Zpc2libGVDbGFzcyIsImNvbnRhaW5zIiwiYWRkIiwic2V0QXR0cmlidXRlIiwib25Qb2ludGVyRG93biIsImUiLCJhZGRJbml0aWFsUG9pbnRlck1vdmVMaXN0ZW5lcnMiLCJvbkluaXRpYWxQb2ludGVyTW92ZSIsInRhcmdldCIsInRvTG93ZXJDYXNlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImFjdGl2ZUVsZW1lbnQiLCJ0eXBlIiwidGFnTmFtZSIsInJlYWRPbmx5IiwiaXNDb250ZW50RWRpdGFibGUiLCJoYXNBdHRyaWJ1dGUiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwicmVtb3ZlQXR0cmlidXRlIiwidmlzaWJpbGl0eVN0YXRlIiwiYm9keSIsImZhY3RvcnkiLCJTcXVhcmVzIiwib3B0aW9ucyIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJjYW52YXMiLCJxdWVyeVNlbGVjdG9yIiwiY29udGV4dCIsImdldENvbnRleHQiLCJjb2xvciIsInNpemUiLCJwcm9wX3NldCIsIm51bV94IiwibnVtX3kiLCJpbml0X2NhbnZhcyIsInByZXBhcmVfY2FudmFzIiwiYXR0YWNoX2V2ZW50cyIsInBhdHRlcm4iLCJwYXJzZV9wYXR0ZXJuIiwiZmlsbCIsIm51bV9ib3hlcyIsIk1hdGgiLCJyb3VuZCIsImdldF9wYXJlbnRfd2lkdGgiLCJzcXVhcmVzIiwicHVzaCIsIngiLCJ5IiwiZHJhd19zcXVhcmVzIiwicGxhY2Vfc3F1YXJlIiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJoZWlnaHQiLCJ4X3JhdyIsInBhZ2VYIiwib2Zmc2V0TGVmdCIsInlfcmF3IiwicGFnZVkiLCJvZmZzZXRUb3AiLCJpbmRleCIsImZpbmRJbmRleCIsInBvcyIsInNwbGljZSIsInByb3AiLCJwYXJlbnRfc3R5bGVzIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsInBhcmVudE5vZGUiLCJwYXJlbnRfd2lkdGgiLCJjbGllbnRXaWR0aCIsInBhcnNlRmxvYXQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsInNwbGl0IiwibGVuZ3RoIiwiYm94IiwicGFyc2VJbnQiLCJ0cmltIiwicm93IiwiZmxvb3IiLCJjb2wiLCJmaWxsU3R5bGUiLCJzcXVhcmUiLCJmaWxsUmVjdCIsInJlcXVlc3RJZGxlQ2FsbGJhY2siLCJjYiIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsImRpZFRpbWVvdXQiLCJ0aW1lUmVtYWluaW5nIiwibWF4IiwicHJlZmV0Y2hOYXYiLCJvYnNlcnZlciIsIm5hdmlnYXRvciIsImNvbm5lY3Rpb24iLCJlZmZlY3RpdmVUeXBlIiwiaW5jbHVkZXMiLCJzYXZlRGF0YSIsImxpbmsiLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJocmVmIiwiY3JlYXRlRWxlbWVudCIsInJlbExpc3QiLCJzdXBwb3J0cyIsInJlbCIsImhlYWQiLCJhcHBlbmRDaGlsZCIsImdldExpbmtzIiwibG9hZEltYWdlIiwiaW1hZ2UiLCJzcmMiLCJkYXRhc2V0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJJbWFnZSIsIm9ubG9hZCIsIm9uZXJyb3IiLCJ0aGVuIiwiaW1hZ2VWaXNpYmxlIiwiZW50cmllcyIsImVudHJ5IiwiaW50ZXJzZWN0aW9uUmF0aW8iLCJ1bm9ic2VydmUiLCJsYXp5TG9hZCIsImltYWdlcyIsIkludGVyc2VjdGlvbk9ic2VydmVyIiwicm9vdE1hcmdpbiIsIm9ic2VydmUiLCJyZXF1aXJlIiwiRWxlbWVudCIsImNsb3Nlc3QiLCJkb2N1bWVudEVsZW1lbnQiLCJtYXRjaGVzIiwicGFyZW50RWxlbWVudCIsIm5vZGVUeXBlIiwiZW1vamlzIiwibGlua1Bvc3RsaXN0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRoZW1lQ2xhc3MiLCJjb25jYXQiLCJwdWJsaWNhdGlvbiIsInBvc3QiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwidGhlbWUiLCJsb2FkUGFnZSIsIm1haW4iLCJpbm5lckhUTUwiLCJyZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwiY29udGFpbmVyIiwic3RhdHVzIiwicmVzcG9uc2UiLCJwYWdlX2NvbnRlbnQiLCJzZW5kIiwidGV4dENvbnRlbnQiLCJyYW5kb20iLCJmb2N1cyIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJyZXBsYWNlIiwib25wb3BzdGF0ZSIsInN0YXRlIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFI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QUFRTyxPQXpFTi9MLFNBQVMyRCxjQUFjLHNCQUN6QjNELFNBQVMyRCxjQUFjLG9CQUFvQnFJLGFBUHJDdEIsRUFBUyxDQUFDLEtBQU0sS0FBTSxLQUFNLE9BQVEsT0FFckJoRyxLQUFLQyxNQUFNRCxLQUFLdUgsVUFBWXZCLEVBQU9oRSxPQUFTLE1BWS9EMUcsU0FBUzJELGNBQWMsbUJBQ3pCM0QsU0FBUzJELGNBQWMsa0JBQWtCckQsaUJBQWlCLFFBQVMsU0FBQTZCLEdBQ2pFQSxFQUFFMEksaUJBQ0Y3SyxTQUFTMkQsY0FBYyxZQUFZdUksVUFRdkN0RSxJQUVBc0QsUUFBUUMsVUFBVSxDQUFFQyxNQUFPZSxTQUFTQyxTQUFTQyxRQUFRLE1BQU8sS0FBT0YsU0FBU0MsU0FBVUQsU0FBU0MsVUFZM0ZwTSxTQUFTMkQsY0FBYyxrQkFDekIzRCxTQUFTMkQsY0FBYyxpQkFBaUJyRCxpQkFBaUIsUUFBU3FLLEdBR3BFcEssT0FBTytMLFdBQWEsU0FBU25LLEdBQ3ZCQSxFQUFFb0ssUUFDSnZNLFNBQVNzSyxnQkFBZ0JySSxhQUFhLGFBQWNFLEVBQUVvSyxNQUFNbkIsT0FDNURDLEVBQVNjLFNBQVNDLFlBc0N0QnRDLEVBQVM5SixTQUFTcUksaUJBQWlCIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gZmFjdG9yeSgpIDpcbiAgdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDpcbiAgKGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogaHR0cHM6Ly9naXRodWIuY29tL1dJQ0cvZm9jdXMtdmlzaWJsZVxuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgaGFkS2V5Ym9hcmRFdmVudCA9IHRydWU7XG4gICAgdmFyIGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5ID0gZmFsc2U7XG4gICAgdmFyIGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5VGltZW91dCA9IG51bGw7XG5cbiAgICB2YXIgaW5wdXRUeXBlc1doaXRlbGlzdCA9IHtcbiAgICAgIHRleHQ6IHRydWUsXG4gICAgICBzZWFyY2g6IHRydWUsXG4gICAgICB1cmw6IHRydWUsXG4gICAgICB0ZWw6IHRydWUsXG4gICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgIHBhc3N3b3JkOiB0cnVlLFxuICAgICAgbnVtYmVyOiB0cnVlLFxuICAgICAgZGF0ZTogdHJ1ZSxcbiAgICAgIG1vbnRoOiB0cnVlLFxuICAgICAgd2VlazogdHJ1ZSxcbiAgICAgIHRpbWU6IHRydWUsXG4gICAgICBkYXRldGltZTogdHJ1ZSxcbiAgICAgICdkYXRldGltZS1sb2NhbCc6IHRydWVcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIGZvciBsZWdhY3kgYnJvd3NlcnMgYW5kIGlmcmFtZXMgd2hpY2ggc29tZXRpbWVzIGZvY3VzXG4gICAgICogZWxlbWVudHMgbGlrZSBkb2N1bWVudCwgYm9keSwgYW5kIG5vbi1pbnRlcmFjdGl2ZSBTVkcuXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzVmFsaWRGb2N1c1RhcmdldChlbCkge1xuICAgICAgaWYgKFxuICAgICAgICBlbCAmJlxuICAgICAgICBlbCAhPT0gZG9jdW1lbnQgJiZcbiAgICAgICAgZWwubm9kZU5hbWUgIT09ICdIVE1MJyAmJlxuICAgICAgICBlbC5ub2RlTmFtZSAhPT0gJ0JPRFknICYmXG4gICAgICAgICdjbGFzc0xpc3QnIGluIGVsICYmXG4gICAgICAgICdjb250YWlucycgaW4gZWwuY2xhc3NMaXN0XG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgd2hldGhlciB0aGUgZ2l2ZW4gZWxlbWVudCBzaG91bGQgYXV0b21hdGljYWxseSB0cmlnZ2VyIHRoZVxuICAgICAqIGBmb2N1cy12aXNpYmxlYCBjbGFzcyBiZWluZyBhZGRlZCwgaS5lLiB3aGV0aGVyIGl0IHNob3VsZCBhbHdheXMgbWF0Y2hcbiAgICAgKiBgOmZvY3VzLXZpc2libGVgIHdoZW4gZm9jdXNlZC5cbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb2N1c1RyaWdnZXJzS2V5Ym9hcmRNb2RhbGl0eShlbCkge1xuICAgICAgdmFyIHR5cGUgPSBlbC50eXBlO1xuICAgICAgdmFyIHRhZ05hbWUgPSBlbC50YWdOYW1lO1xuXG4gICAgICBpZiAodGFnTmFtZSA9PSAnSU5QVVQnICYmIGlucHV0VHlwZXNXaGl0ZWxpc3RbdHlwZV0gJiYgIWVsLnJlYWRPbmx5KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodGFnTmFtZSA9PSAnVEVYVEFSRUEnICYmICFlbC5yZWFkT25seSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGVsLmlzQ29udGVudEVkaXRhYmxlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHRoZSBgZm9jdXMtdmlzaWJsZWAgY2xhc3MgdG8gdGhlIGdpdmVuIGVsZW1lbnQgaWYgaXQgd2FzIG5vdCBhZGRlZCBieVxuICAgICAqIHRoZSBhdXRob3IuXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEZvY3VzVmlzaWJsZUNsYXNzKGVsKSB7XG4gICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdmb2N1cy12aXNpYmxlJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZm9jdXMtdmlzaWJsZScpO1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLWZvY3VzLXZpc2libGUtYWRkZWQnLCAnJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoZSBgZm9jdXMtdmlzaWJsZWAgY2xhc3MgZnJvbSB0aGUgZ2l2ZW4gZWxlbWVudCBpZiBpdCB3YXMgbm90XG4gICAgICogb3JpZ2luYWxseSBhZGRlZCBieSB0aGUgYXV0aG9yLlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVGb2N1c1Zpc2libGVDbGFzcyhlbCkge1xuICAgICAgaWYgKCFlbC5oYXNBdHRyaWJ1dGUoJ2RhdGEtZm9jdXMtdmlzaWJsZS1hZGRlZCcpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZvY3VzLXZpc2libGUnKTtcbiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1mb2N1cy12aXNpYmxlLWFkZGVkJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJlYXQgYGtleWRvd25gIGFzIGEgc2lnbmFsIHRoYXQgdGhlIHVzZXIgaXMgaW4ga2V5Ym9hcmQgbW9kYWxpdHkuXG4gICAgICogQXBwbHkgYGZvY3VzLXZpc2libGVgIHRvIGFueSBjdXJyZW50IGFjdGl2ZSBlbGVtZW50IGFuZCBrZWVwIHRyYWNrXG4gICAgICogb2Ygb3VyIGtleWJvYXJkIG1vZGFsaXR5IHN0YXRlIHdpdGggYGhhZEtleWJvYXJkRXZlbnRgLlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvbktleURvd24oZSkge1xuICAgICAgaWYgKGlzVmFsaWRGb2N1c1RhcmdldChkb2N1bWVudC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgICBhZGRGb2N1c1Zpc2libGVDbGFzcyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgaGFkS2V5Ym9hcmRFdmVudCA9IHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgYXQgYW55IHBvaW50IGEgdXNlciBjbGlja3Mgd2l0aCBhIHBvaW50aW5nIGRldmljZSwgZW5zdXJlIHRoYXQgd2UgY2hhbmdlXG4gICAgICogdGhlIG1vZGFsaXR5IGF3YXkgZnJvbSBrZXlib2FyZC5cbiAgICAgKiBUaGlzIGF2b2lkcyB0aGUgc2l0dWF0aW9uIHdoZXJlIGEgdXNlciBwcmVzc2VzIGEga2V5IG9uIGFuIGFscmVhZHkgZm9jdXNlZFxuICAgICAqIGVsZW1lbnQsIGFuZCB0aGVuIGNsaWNrcyBvbiBhIGRpZmZlcmVudCBlbGVtZW50LCBmb2N1c2luZyBpdCB3aXRoIGFcbiAgICAgKiBwb2ludGluZyBkZXZpY2UsIHdoaWxlIHdlIHN0aWxsIHRoaW5rIHdlJ3JlIGluIGtleWJvYXJkIG1vZGFsaXR5LlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvblBvaW50ZXJEb3duKGUpIHtcbiAgICAgIGhhZEtleWJvYXJkRXZlbnQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPbiBgZm9jdXNgLCBhZGQgdGhlIGBmb2N1cy12aXNpYmxlYCBjbGFzcyB0byB0aGUgdGFyZ2V0IGlmOlxuICAgICAqIC0gdGhlIHRhcmdldCByZWNlaXZlZCBmb2N1cyBhcyBhIHJlc3VsdCBvZiBrZXlib2FyZCBuYXZpZ2F0aW9uLCBvclxuICAgICAqIC0gdGhlIGV2ZW50IHRhcmdldCBpcyBhbiBlbGVtZW50IHRoYXQgd2lsbCBsaWtlbHkgcmVxdWlyZSBpbnRlcmFjdGlvblxuICAgICAqICAgdmlhIHRoZSBrZXlib2FyZCAoZS5nLiBhIHRleHQgYm94KVxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvbkZvY3VzKGUpIHtcbiAgICAgIC8vIFByZXZlbnQgSUUgZnJvbSBmb2N1c2luZyB0aGUgZG9jdW1lbnQgb3IgSFRNTCBlbGVtZW50LlxuICAgICAgaWYgKCFpc1ZhbGlkRm9jdXNUYXJnZXQoZS50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKGhhZEtleWJvYXJkRXZlbnQgfHwgZm9jdXNUcmlnZ2Vyc0tleWJvYXJkTW9kYWxpdHkoZS50YXJnZXQpKSB7XG4gICAgICAgIGFkZEZvY3VzVmlzaWJsZUNsYXNzKGUudGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPbiBgYmx1cmAsIHJlbW92ZSB0aGUgYGZvY3VzLXZpc2libGVgIGNsYXNzIGZyb20gdGhlIHRhcmdldC5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25CbHVyKGUpIHtcbiAgICAgIGlmICghaXNWYWxpZEZvY3VzVGFyZ2V0KGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdmb2N1cy12aXNpYmxlJykgfHxcbiAgICAgICAgZS50YXJnZXQuaGFzQXR0cmlidXRlKCdkYXRhLWZvY3VzLXZpc2libGUtYWRkZWQnKVxuICAgICAgKSB7XG4gICAgICAgIC8vIFRvIGRldGVjdCBhIHRhYi93aW5kb3cgc3dpdGNoLCB3ZSBsb29rIGZvciBhIGJsdXIgZXZlbnQgZm9sbG93ZWRcbiAgICAgICAgLy8gcmFwaWRseSBieSBhIHZpc2liaWxpdHkgY2hhbmdlLlxuICAgICAgICAvLyBJZiB3ZSBkb24ndCBzZWUgYSB2aXNpYmlsaXR5IGNoYW5nZSB3aXRoaW4gMTAwbXMsIGl0J3MgcHJvYmFibHkgYVxuICAgICAgICAvLyByZWd1bGFyIGZvY3VzIGNoYW5nZS5cbiAgICAgICAgaGFkRm9jdXNWaXNpYmxlUmVjZW50bHkgPSB0cnVlO1xuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5VGltZW91dCk7XG4gICAgICAgIGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5VGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5ID0gZmFsc2U7XG4gICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChoYWRGb2N1c1Zpc2libGVSZWNlbnRseVRpbWVvdXQpO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgICByZW1vdmVGb2N1c1Zpc2libGVDbGFzcyhlLnRhcmdldCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIHVzZXIgY2hhbmdlcyB0YWJzLCBrZWVwIHRyYWNrIG9mIHdoZXRoZXIgb3Igbm90IHRoZSBwcmV2aW91c2x5XG4gICAgICogZm9jdXNlZCBlbGVtZW50IGhhZCAuZm9jdXMtdmlzaWJsZS5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25WaXNpYmlsaXR5Q2hhbmdlKGUpIHtcbiAgICAgIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT0gJ2hpZGRlbicpIHtcbiAgICAgICAgLy8gSWYgdGhlIHRhYiBiZWNvbWVzIGFjdGl2ZSBhZ2FpbiwgdGhlIGJyb3dzZXIgd2lsbCBoYW5kbGUgY2FsbGluZyBmb2N1c1xuICAgICAgICAvLyBvbiB0aGUgZWxlbWVudCAoU2FmYXJpIGFjdHVhbGx5IGNhbGxzIGl0IHR3aWNlKS5cbiAgICAgICAgLy8gSWYgdGhpcyB0YWIgY2hhbmdlIGNhdXNlZCBhIGJsdXIgb24gYW4gZWxlbWVudCB3aXRoIGZvY3VzLXZpc2libGUsXG4gICAgICAgIC8vIHJlLWFwcGx5IHRoZSBjbGFzcyB3aGVuIHRoZSB1c2VyIHN3aXRjaGVzIGJhY2sgdG8gdGhlIHRhYi5cbiAgICAgICAgaWYgKGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5KSB7XG4gICAgICAgICAgaGFkS2V5Ym9hcmRFdmVudCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgYWRkSW5pdGlhbFBvaW50ZXJNb3ZlTGlzdGVuZXJzKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgZ3JvdXAgb2YgbGlzdGVuZXJzIHRvIGRldGVjdCB1c2FnZSBvZiBhbnkgcG9pbnRpbmcgZGV2aWNlcy5cbiAgICAgKiBUaGVzZSBsaXN0ZW5lcnMgd2lsbCBiZSBhZGRlZCB3aGVuIHRoZSBwb2x5ZmlsbCBmaXJzdCBsb2FkcywgYW5kIGFueXRpbWVcbiAgICAgKiB0aGUgd2luZG93IGlzIGJsdXJyZWQsIHNvIHRoYXQgdGhleSBhcmUgYWN0aXZlIHdoZW4gdGhlIHdpbmRvdyByZWdhaW5zXG4gICAgICogZm9jdXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWRkSW5pdGlhbFBvaW50ZXJNb3ZlTGlzdGVuZXJzKCkge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVtb3ZlSW5pdGlhbFBvaW50ZXJNb3ZlTGlzdGVuZXJzKCkge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2hlbiB0aGUgcG9sZnlpbGwgZmlyc3QgbG9hZHMsIGFzc3VtZSB0aGUgdXNlciBpcyBpbiBrZXlib2FyZCBtb2RhbGl0eS5cbiAgICAgKiBJZiBhbnkgZXZlbnQgaXMgcmVjZWl2ZWQgZnJvbSBhIHBvaW50aW5nIGRldmljZSAoZS5nLiBtb3VzZSwgcG9pbnRlcixcbiAgICAgKiB0b3VjaCksIHR1cm4gb2ZmIGtleWJvYXJkIG1vZGFsaXR5LlxuICAgICAqIFRoaXMgYWNjb3VudHMgZm9yIHNpdHVhdGlvbnMgd2hlcmUgZm9jdXMgZW50ZXJzIHRoZSBwYWdlIGZyb20gdGhlIFVSTCBiYXIuXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKGUpIHtcbiAgICAgIC8vIFdvcmsgYXJvdW5kIGEgU2FmYXJpIHF1aXJrIHRoYXQgZmlyZXMgYSBtb3VzZW1vdmUgb24gPGh0bWw+IHdoZW5ldmVyIHRoZVxuICAgICAgLy8gd2luZG93IGJsdXJzLCBldmVuIGlmIHlvdSdyZSB0YWJiaW5nIG91dCBvZiB0aGUgcGFnZS4gwq9cXF8o44OEKV8vwq9cbiAgICAgIGlmIChlLnRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaHRtbCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBoYWRLZXlib2FyZEV2ZW50ID0gZmFsc2U7XG4gICAgICByZW1vdmVJbml0aWFsUG9pbnRlck1vdmVMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIG9uUG9pbnRlckRvd24sIHRydWUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIG9uRm9jdXMsIHRydWUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvbkJsdXIsIHRydWUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCBvblZpc2liaWxpdHlDaGFuZ2UsIHRydWUpO1xuICAgIGFkZEluaXRpYWxQb2ludGVyTW92ZUxpc3RlbmVycygpO1xuXG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdqcy1mb2N1cy12aXNpYmxlJyk7XG4gIH1cblxuICAvKipcbiAgICogU3Vic2NyaXB0aW9uIHdoZW4gdGhlIERPTSBpcyByZWFkeVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgKi9cbiAgZnVuY3Rpb24gb25ET01SZWFkeShjYWxsYmFjaykge1xuICAgIHZhciBsb2FkZWQ7XG5cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayB3cmFwcGVyIGZvciBjaGVjayBsb2FkZWQgc3RhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgaWYgKCFsb2FkZWQpIHtcbiAgICAgICAgbG9hZGVkID0gdHJ1ZTtcblxuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChbJ2ludGVyYWN0aXZlJywgJ2NvbXBsZXRlJ10uaW5kZXhPZihkb2N1bWVudC5yZWFkeVN0YXRlKSA+PSAwKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsb2FkZWQgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBsb2FkLCBmYWxzZSk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGxvYWQsIGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgIG9uRE9NUmVhZHkoaW5pdCk7XG4gIH1cblxufSkpKTtcbiIsImNsYXNzIFNxdWFyZXMge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLmNhbnZhcyk7XG5cbiAgICBpZiAoIXRoaXMuY2FudmFzKSByZXR1cm47XG5cbiAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMuY29sb3IgPSdyZWQnO1xuXG4gICAgdGhpcy5zaXplID0gdGhpcy5wcm9wX3NldChvcHRpb25zLnNpemUsIDIwKTtcblxuICAgIHRoaXMubnVtX3ggPSBvcHRpb25zLm51bV94O1xuICAgIHRoaXMubnVtX3kgPSBvcHRpb25zLm51bV95O1xuXG4gICAgdGhpcy5pbml0X2NhbnZhcygpO1xuICB9XG5cbiAgaW5pdF9jYW52YXMoKSB7XG4gICAgdGhpcy5wcmVwYXJlX2NhbnZhcygpO1xuICAgIHRoaXMuYXR0YWNoX2V2ZW50cygpO1xuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5wYXR0ZXJuKSB7XG4gICAgICB0aGlzLnBhcnNlX3BhdHRlcm4oKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmZpbGwpIHtcbiAgICAgIGNvbnN0IG51bV9ib3hlcyA9IE1hdGgucm91bmQodGhpcy5nZXRfcGFyZW50X3dpZHRoKCkgLyB0aGlzLnNpemUgLyAyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1fYm94ZXM7IGkrKykge1xuICAgICAgICB0aGlzLnNxdWFyZXMucHVzaCh7IHg6IHRoaXMuc2l6ZSAqICgyICogaSksIHk6IDAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZHJhd19zcXVhcmVzKCk7XG4gICAgfVxuICB9XG5cbiAgYXR0YWNoX2V2ZW50cygpIHtcbiAgICB0aGlzLnBsYWNlX3NxdWFyZSA9IHRoaXMucGxhY2Vfc3F1YXJlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnBsYWNlX3NxdWFyZSk7XG4gIH1cblxuICBwbGFjZV9zcXVhcmUoZSkge1xuICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XG5cbiAgICAgIGNvbnN0IHhfcmF3ID0gZS5wYWdlWCAtIGUudGFyZ2V0Lm9mZnNldExlZnQ7XG4gICAgICBjb25zdCB5X3JhdyA9IGUucGFnZVkgLSBlLnRhcmdldC5vZmZzZXRUb3A7XG5cbiAgICAgIGxldCB4ID0geF9yYXcgLSB4X3JhdyAlIHRoaXMuc2l6ZTtcbiAgICAgIGxldCB5ID0geV9yYXcgLSB5X3JhdyAlIHRoaXMuc2l6ZTtcblxuICAgICAgaWYgKHkgPT09IHRoaXMuY2FudmFzLmhlaWdodCkge1xuICAgICAgICB5IC09IHRoaXMuc2l6ZTtcbiAgICAgIH1cbiAgICAgIGlmICh4ID09PSB0aGlzLmNhbnZhcy53aWR0aCkge1xuICAgICAgICB4IC09IHRoaXMuc2l6ZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNxdWFyZXMuZmluZEluZGV4KHBvcyA9PiBwb3MueCA9PT0geCAmIHBvcy55ID09PSB5KTtcblxuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgdGhpcy5zcXVhcmVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNxdWFyZXMucHVzaCh7IHg6IHgsIHk6IHl9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5kcmF3X3NxdWFyZXModGhpcy5jb250ZXh0LCB0aGlzLnNxdWFyZXMpO1xuICB9XG5cbiAgcHJvcF9zZXQocHJvcCwgdmFsdWUpIHtcbiAgICByZXR1cm4gcHJvcCA/IHByb3AgOiB2YWx1ZTtcbiAgfVxuXG4gIHByZXBhcmVfY2FudmFzKCkge1xuICAgIHRoaXMuY2FudmFzLmNsYXNzTGlzdC5hZGQoJ3NxdWFyZS1jYW52YXMtLXZpc2libGUnKVxuXG4gICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLm51bV94ICogdGhpcy5zaXplO1xuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMubnVtX3kgKiB0aGlzLnNpemU7XG5cbiAgICBpZiAodGhpcy5udW1feCA9PT0gJ2luZmluaXRlJykgeyAgXG4gICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuZ2V0X3BhcmVudF93aWR0aCgpO1xuICAgIH1cblxuICAgIHRoaXMuc3F1YXJlcyA9IFtdO1xuICB9XG5cbiAgZ2V0X3BhcmVudF93aWR0aCgpIHtcbiAgICBjb25zdCBwYXJlbnRfc3R5bGVzID0gZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmNhbnZhcy5wYXJlbnROb2RlKTtcbiAgICBsZXQgcGFyZW50X3dpZHRoID0gdGhpcy5jYW52YXMucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcbiAgICBwYXJlbnRfd2lkdGggLT0gcGFyc2VGbG9hdChwYXJlbnRfc3R5bGVzLnBhZGRpbmdMZWZ0KSArIHBhcnNlRmxvYXQocGFyZW50X3N0eWxlcy5wYWRkaW5nUmlnaHQpO1xuXG4gICAgcmV0dXJuIHBhcmVudF93aWR0aDtcbiAgfVxuXG4gIHBhcnNlX3BhdHRlcm4oKSB7XG4gICAgY29uc3QgcGF0dGVybiA9IHRoaXMub3B0aW9ucy5wYXR0ZXJuLnNwbGl0KCcsJyk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdHRlcm4ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGJveCA9IHBhcnNlSW50KHBhdHRlcm5baV0udHJpbSgpKTtcbiAgICAgIGxldCByb3cgPSBNYXRoLmZsb29yKGkgLyB0aGlzLm51bV94KTtcbiAgICAgIGxldCBjb2wgPSAoaSArIHRoaXMubnVtX3gpICUgdGhpcy5udW1feDtcblxuICAgICAgaWYgKHRoaXMubnVtX3ggPT09ICdpbmZpbml0ZScpIHtcbiAgICAgICAgcm93ID0gMDtcbiAgICAgICAgY29sID0gaTtcbiAgICAgIH1cblxuICAgICAgaWYgKGJveCkge1xuICAgICAgICB0aGlzLnNxdWFyZXMucHVzaCh7IHg6IHRoaXMuc2l6ZSAqIGNvbCwgeTogdGhpcy5zaXplICogcm93IH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZHJhd19zcXVhcmVzKCk7XG4gIH1cblxuICBkcmF3X3NxdWFyZXMoKSB7XG4gICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IHRoaXMucHJvcF9zZXQodGhpcy5vcHRpb25zLmNvbG9yLCAncmdiYSg1MSwgNTEsIDUxLCAwLjkpJyk7XG5cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5zcXVhcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSB0aGlzLnNxdWFyZXNbaV07XG4gICAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3Qoc3F1YXJlLngsIHNxdWFyZS55LCB0aGlzLnNpemUsIHRoaXMuc2l6ZSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNxdWFyZXM7XG5cblxuIiwiY29uc3QgcmVxdWVzdElkbGVDYWxsYmFjayA9IHJlcXVlc3RJZGxlQ2FsbGJhY2sgfHxcbiAgZnVuY3Rpb24gKGNiKSB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGNiKHtcbiAgICAgICAgZGlkVGltZW91dDogZmFsc2UsXG4gICAgICAgIHRpbWVSZW1haW5pbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgNTAgLSAoRGF0ZS5ub3coKSAtIHN0YXJ0KSk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9LCAxKTtcbiAgfTtcblxuZXhwb3J0IGRlZmF1bHQgcmVxdWVzdElkbGVDYWxsYmFjaztcbiIsIi8qKlxuICogSW5zcGlyZWQgYnkgcXVpY2tsaW5rLlxuICogaHR0cHM6Ly9naXRodWIuY29tL0dvb2dsZUNocm9tZUxhYnMvcXVpY2tsaW5rXG4gKi9cbiBcbmltcG9ydCByZXF1ZXN0SWRsZUNhbGxiYWNrIGZyb20gJy4vcmVxdWVzdC1pZGxlLWNhbGxiYWNrLmpzJztcblxuZnVuY3Rpb24gY3JlYXRlUHJlZmV0Y2hMaW5rKHVybCkge1xuICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpO1xuXG4gIC8vIElmIHByZWZldGNoIHN1cHBvcnRlZCAgICBcbiAgaWYgKChsaW5rLnJlbExpc3QgfHwge30pLnN1cHBvcnRzICYmICFsaW5rLnJlbExpc3Quc3VwcG9ydHMoJ3ByZWZldGNoJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsaW5rLnJlbCA9ICdwcmVmZXRjaCc7XG4gIGxpbmsuaHJlZiA9IHVybDtcblxuICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGxpbmspO1xufVxuXG5mdW5jdGlvbiBnZXRMaW5rcygpIHtcbiAgLy8gR2V0IGFsbCBsaW5rcyBpbiBtYWluIG5hdlxuICBjb25zdCBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1uYXYtbWFpbiBhJyk7XG5cbiAgZm9yKGxldCBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgY3JlYXRlUHJlZmV0Y2hMaW5rKGxpbmtzW2ldLmhyZWYpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHByZWZldGNoTmF2KCkge1xuICAvLyBkb24ndCBwcmVmZXRjaCBpZiAyZyBjb25uZWN0aW9uIG9yIGRhdGEtc2F2ZXIgZW5hYmxlZFxuICBpZiAobmF2aWdhdG9yLmNvbm5lY3Rpb24pIHtcbiAgICBpZiAobmF2aWdhdG9yLmNvbm5lY3Rpb24uZWZmZWN0aXZlVHlwZS5pbmNsdWRlcygnMmcnKSB8fCBuYXZpZ2F0b3IuY29ubmVjdGlvbi5zYXZlRGF0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIC8vIHN0YXJ0IGFzIHNvb24gYXMgdGhlIGJyb3dzZXIgaXNuJ3QgYnVzeSBhbnltb3JlXG4gIHJlcXVlc3RJZGxlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGdldExpbmtzKCk7XG4gIH0pXG59XG5cbmV4cG9ydCBkZWZhdWx0IHByZWZldGNoTmF2O1xuIiwibGV0IG9ic2VydmVyO1xuXG5mdW5jdGlvbiBsb2FkSW1hZ2UoaW1hZ2UpIHtcbiAgY29uc3Qgc3JjID0gaW1hZ2UuZGF0YXNldC5zcmM7XG4gIHJldHVybiBmZXRjaEltYWdlKHNyYykudGhlbigoKSA9PiB7IFxuICAgIGltYWdlLmNsYXNzTGlzdC5hZGQoJ2xhenlsb2FkZWQnKTtcbiAgICBpbWFnZS5zcmMgPSBzcmM7XG4gICAgaW1hZ2UucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1zcmNcIik7XG4gICB9KTtcbn1cblxuZnVuY3Rpb24gZmV0Y2hJbWFnZSh1cmwpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgIGltYWdlLnNyYyA9IHVybDtcbiAgICBpbWFnZS5vbmxvYWQgPSByZXNvbHZlO1xuICAgIGltYWdlLm9uZXJyb3IgPSByZWplY3Q7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpbWFnZVZpc2libGUoZW50cmllcykge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpKyspIHsgXG4gICAgbGV0IGVudHJ5ID0gZW50cmllc1tpXTtcbiAgICBpZiAoZW50cnkuaW50ZXJzZWN0aW9uUmF0aW8gPiAwKSB7XG4gICAgICBvYnNlcnZlci51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcbiAgICAgIGxvYWRJbWFnZShlbnRyeS50YXJnZXQpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBsYXp5TG9hZChpbWFnZXMpIHtcbiAgaWYgKGltYWdlcy5sZW5ndGgpIHtcbiAgICBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihpbWFnZVZpc2libGUsIHsgcm9vdE1hcmdpbjogJzEwMHB4IDBweCcsIH0pO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZXMubGVuZ3RoOyBpKyspIHsgXG4gICAgICBsZXQgaW1hZ2UgPSBpbWFnZXNbaV07XG4gICAgICBpZiAoaW1hZ2UuY2xhc3NMaXN0LmNvbnRhaW5zKCdsYXp5bG9hZGVkJykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIG9ic2VydmVyLm9ic2VydmUoaW1hZ2UpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBsYXp5TG9hZDtcbiIsImltcG9ydCBTcXVhcmVzIGZyb20gJy4vc3F1YXJlcyc7XG5pbXBvcnQgcHJlZmV0Y2hOYXYgZnJvbSAnLi9wcmVmZXRjaC1uYXYnO1xuaW1wb3J0IGxhenlMb2FkIGZyb20gJy4vbGF6eWxvYWQnO1xucmVxdWlyZSgnZm9jdXMtdmlzaWJsZScpO1xuXG5pZiAoIUVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QpIHtcbiAgRWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdCA9IGZ1bmN0aW9uKHMpIHtcbiAgICB2YXIgZWwgPSB0aGlzO1xuICAgIGlmICghZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKGVsKSkgcmV0dXJuIG51bGw7XG4gICAgZG8ge1xuICAgICAgaWYgKGVsLm1hdGNoZXMocykpIHJldHVybiBlbDtcbiAgICAgIGVsID0gZWwucGFyZW50RWxlbWVudCB8fCBlbC5wYXJlbnROb2RlO1xuICAgIH0gd2hpbGUgKGVsICE9PSBudWxsICYmIGVsLm5vZGVUeXBlID09PSAxKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcbn1cblxuY29uc3QgaG9tZV90bCA9IG5ldyBTcXVhcmVzKHtcbiAgY2FudmFzOiAnLmpzLXNxLXRsJyxcbiAgbnVtX3g6IDEsXG4gIG51bV95OiAxLFxuICBwYXR0ZXJuOiAnMScsXG4gIGNvbG9yOiAnIzM2QjFCRidcbn0pO1xuXG5jb25zdCBob21lX3RyID0gbmV3IFNxdWFyZXMoe1xuICBjYW52YXM6ICcuanMtc3EtdHInLFxuICBudW1feDogMixcbiAgbnVtX3k6IDEsXG4gIHBhdHRlcm46ICcxLDEnLFxuICBjb2xvcjogJyMzNkIxQkYnXG59KTtcblxuY29uc3QgaG9tZV9iciA9IG5ldyBTcXVhcmVzKHtcbiAgY2FudmFzOiAnLmpzLXNxLWJyJyxcbiAgbnVtX3g6IDEsXG4gIG51bV95OiAyLFxuICBwYXR0ZXJuOiAnMSwxJyxcbiAgY29sb3I6ICcjRjIzQzUwJ1xufSk7XG5cbmNvbnN0IGhvbWVfYmwgPSBuZXcgU3F1YXJlcyh7XG4gIGNhbnZhczogJy5qcy1zcS1ibCcsXG4gIG51bV94OiAyLFxuICBudW1feTogMixcbiAgcGF0dGVybjogJzEsMCwxLDEnLFxuICBjb2xvcjogJyNGMjNDNTAnXG59KTtcblxuY29uc3QgaG9tZV9pbnRybyA9IG5ldyBTcXVhcmVzKHtcbiAgY2FudmFzOiAnLmpzLXNxLWhvbWUtaW50cm8nLFxuICBudW1feDogNixcbiAgbnVtX3k6IDUsXG4gIGNvbG9yOiAnIzU2OGI4ZScsXG4gIHNpemU6IDEwLFxuICBwYXR0ZXJuOiBgMCwwLDEsMSwwLDEsXG4gICAgMCwxLDEsMCwwLDEsXG4gICAgMSwxLDAsMCwwLDEsXG4gICAgMCwxLDEsMCwwLDAsXG4gICAgMCwwLDEsMSwwLDFgXG59KTtcblxuY29uc3Qgc2l0ZV9oZWFkZXIgPSBuZXcgU3F1YXJlcyh7XG4gIGNhbnZhczogJy5qcy1zcS1zaXRlLWhlYWRlcicsXG4gIG51bV94OiAnaW5maW5pdGUnLFxuICBudW1feTogMSxcbiAgc2l6ZTogNSxcbiAgY29sb3I6ICcjMWQ0ZTZkJyxcbiAgZmlsbDogJ2V2ZW4nXG59KTtcblxuLyoqXG4gKiBSYW5kb20gZW1vamlcbiAqL1xuXG5mdW5jdGlvbiBnZXRSYW5kb21FbW9qaSgpIHtcbiAgY29uc3QgZW1vamlzID0gWyfwn6SkJywgJ/CfkLMnLCAn8J+NuycsICfwn5GK8J+PuycsICfwn42zJ107XG5cbiAgY29uc3QgZW1vamkgPSBlbW9qaXNbTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKGVtb2ppcy5sZW5ndGggLSAxKSldO1xuICByZXR1cm4gZW1vamk7XG59XG5cbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtcmFuZG9tLWVtb2ppJykpIHtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXJhbmRvbS1lbW9qaScpLnRleHRDb250ZW50ID0gZ2V0UmFuZG9tRW1vamkoKTtcbn1cblxuLyoqXG4gKiBTbW9vdGhseSBzY3JvbGwgdG8gdG9wXG4gKi9cblxuaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1zY3JvbGwtdG9wJykpIHtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXNjcm9sbC10b3AnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbG9nbycpLmZvY3VzKCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFByZWZldGNoIGxpbmtzIGluIG5hdiBmb3IgYmV0dGVyIHBlcmNlaXZlZCBwZXJmb3JtYW5jZVxuICovXG5cbnByZWZldGNoTmF2KCk7XG5cbmhpc3RvcnkucHVzaFN0YXRlKHsgdGhlbWU6IGxvY2F0aW9uLnBhdGhuYW1lLnJlcGxhY2UoL1xcLy9nLCAnJykgfSwgbG9jYXRpb24ucGF0aG5hbWUsIGxvY2F0aW9uLnBhdGhuYW1lKTtcblxuZnVuY3Rpb24gbGlua1Bvc3RsaXN0KCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBsaW5rID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ2EnKTtcbiAgY29uc3QgdGhlbWVDbGFzcyA9IGAke2xpbmsuZGF0YXNldC5wdWJsaWNhdGlvbn0tJHtsaW5rLmRhdGFzZXQucG9zdH1gO1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJywgdGhlbWVDbGFzcyk7XG4gIGhpc3RvcnkucHVzaFN0YXRlKHsgdGhlbWU6IHRoZW1lQ2xhc3MgfSwgbGluay5ocmVmLCBsaW5rLmhyZWYpO1xuICBsb2FkUGFnZShsaW5rLmhyZWYpO1xufVxuXG5cbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtcG9zdC1saXN0JykpIHtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXBvc3QtbGlzdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGlua1Bvc3RsaXN0KTtcbn1cblxud2luZG93Lm9ucG9wc3RhdGUgPSBmdW5jdGlvbihlKSB7XG4gIGlmIChlLnN0YXRlKSB7XG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScsIGUuc3RhdGUudGhlbWUpO1xuICAgIGxvYWRQYWdlKGxvY2F0aW9uLnBhdGhuYW1lKTtcbiAgfVxufTtcblxuXG5mdW5jdGlvbiBsb2FkUGFnZSh1cmwpIHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1zaXRlLWNvbnRlbnQnKTtcbiAgbWFpbi5pbm5lckhUTUwgPSAnJztcbiAgbWFpbi5jbGFzc0xpc3QuYWRkKCdzaXRlX19jb250ZW50LS1oaWRkZW4nKTtcblxuICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gIHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTtcblxuICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSB0aGlzLnJlc3BvbnNlO1xuICAgICAgbWFpbi5pbm5lckhUTUwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmpzLXNpdGUtY29udGVudCcpLmlubmVySFRNTDtcbiAgICAgIG1haW4uY2xhc3NMaXN0LnJlbW92ZSgnc2l0ZV9fY29udGVudC0taGlkZGVuJyk7XG4gICAgICBpZiAobWFpbi5xdWVyeVNlbGVjdG9yKCcuanMtcG9zdC1saXN0JykpIHtcbiAgICAgICAgbWFpbi5xdWVyeVNlbGVjdG9yKCcuanMtcG9zdC1saXN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaW5rUG9zdGxpc3QpO1xuICAgICAgfVxuXG4gICAgICBsYXp5TG9hZChtYWluLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbWdbZGF0YS1zcmNdXCIpKTtcbiAgICB9XG4gIH07XG5cbiAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgcGFnZV9jb250ZW50LmlubmVySFRNTCA9ICdGb3Igc29tZSByZWFzb24gSSBjb3VsZG5cXCd0IGNvbm5lY3QgdG8gdGhlIHNlcnZlciwgcGxlYXNlIHRyeSBsYXRlciBhZ2Fpbi4nO1xuICB9O1xuXG4gIHJlcXVlc3Quc2VuZCgpO1xufVxuXG4vLyBMYXp5IGxvYWQgaW1hZ2VzXG5cbmxhenlMb2FkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbWdbZGF0YS1zcmNdXCIpKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=